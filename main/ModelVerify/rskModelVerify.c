#include "rskModelVerify.h"
#include "rsk.h"

float fft_test_vdata[120] = {
    3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,
    3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,
    3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,
    3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,
    3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,
    3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,
    3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,
    3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,
    3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,
    3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798,3.5798
};

float fft_test_data[120] = {
    18.85,  18.85,  18.85,  18.85,  18.85,  18.85,  18.6431,18.6431,18.6431,18.8317,18.8317,18.8317,
    18.631, 18.631, 18.631, 18.631, 18.631, 18.631, 18.631, 18.631, 18.631, 18.631, 18.631, 18.631,
    18.631, 18.8285,18.6357,18.6357,18.6357,18.6357,18.6357,18.6357,18.6357,18.6357,18.6357,18.6357,
    18.6357,18.6357,18.6357,18.6357,18.6357,18.6357,18.6357,18.6357,18.6357,18.6357,18.6357,18.6357,
    18.8238,18.8238,18.8238,18.8238,18.8238,18.8238,18.8238,18.8238,18.8238,18.8238,18.8238,18.8238,
    18.6319,18.6319,18.6319,18.6319,18.6319,18.6319,18.8183,18.8183,18.8183,18.8183,18.8183,18.8183,
    18.8183,18.8183,18.8183,18.8183,18.8183,18.6258,18.6258,18.6258,18.6258,18.6258,18.6258,18.6258,
    18.6258,18.8203,18.8203,18.8203,18.8203,18.8203,18.8203,18.8203,18.8203,18.8203,18.8203,18.8203,
    18.8203,18.8203,18.8203,18.8203,18.8203,18.8203,18.8203,18.8203,18.8203,18.6058,18.6058,18.6058,
    18.6058,18.6058,18.6058,18.801, 18.801, 18.801, 18.801, 18.6095,18.7994,18.7994,18.7994,18.7994
};

void rskVerity_data_get_task_handler(void *parameters)
{
    uint16_t index = 0;
    while(1){
        float inputData[3];
        inputData[0] = fft_test_vdata[index];
        inputData[1] = fft_test_data[index];
        rsk_fft_input_data_fill(inputData,3);
        index++;
        index %= 120;
        rsk_inference_task_handler(NULL);
        vTaskDelay(pdMS_TO_TICKS(1000));
    }
}


void rskModelVerify_init(void)
{
    //创建电池数据更新任务
    xTaskCreatePinnedToCore(rskVerity_data_get_task_handler,"rskVerTask",1024*5,NULL,6,NULL,1);
    //创建推理任务
    // xTaskCreatePinnedToCore(socVerity_inference_task_handler,"VerInfTask",1024*5,NULL,6,NULL,1);
}


